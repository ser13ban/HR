# Feedback Feature Implementation Plan

## Brief Description
Implement a comprehensive feedback system that allows users to view all their received feedback on their own profile page via a dedicated button that navigates to a feedback page. When viewing co-worker profiles, users can provide feedback with an option to remain anonymous. The feature leverages the existing Feedback model and database schema.

## Backend Changes

### API Controller - New FeedbackController
**File**: `HrAPI/HrAPI/Controllers/FeedbackController.cs` (CREATE)
- `GET /api/feedback/received/{employeeId}` - Get all feedback received by an employee (filtered by permissions)
- `GET /api/feedback/given/{employeeId}` - Get all feedback given by an employee (for own profile only)
- `POST /api/feedback` - Create new feedback for a co-worker
- `GET /api/feedback/{id}` - Get specific feedback by ID (with permission checks)

### DTOs - New Data Transfer Objects
**File**: `HrAPI/HrAPI/DTOs/FeedbackDto.cs` (CREATE)
- `FeedbackListDto` - For displaying feedback in lists (handles anonymous display)
- `CreateFeedbackDto` - For creating new feedback
- `FeedbackDetailDto` - For detailed feedback view

### Service Layer - New FeedbackService
**File**: `HrAPI/HrAPI/Services/IFeedbackService.cs` (CREATE)
**File**: `HrAPI/HrAPI/Services/FeedbackService.cs` (CREATE)
- Business logic for feedback operations
- Permission validation (prevent self-feedback, role-based access)
- Anonymous feedback handling logic

### Update Program.cs
**File**: `HrAPI/HrAPI/Program.cs` (MODIFY)
- Register `IFeedbackService` and `FeedbackService` in DI container

## Frontend Changes

### New Feedback Components
**Directory**: `hr-app/src/app/features/feedback/` (CREATE)

#### Feedback List Component
**Files**: 
- `feedback-list/feedback-list.component.ts` (CREATE)
- `feedback-list/feedback-list.component.html` (CREATE) 
- `feedback-list/feedback-list.component.sass` (CREATE)

Displays all feedback for the current user with:
- List view of received feedback
- Anonymous feedback handling (show "Anonymous" instead of sender name)
- Feedback type categorization
- Rating display
- Date formatting

#### Give Feedback Component  
**Files**:
- `give-feedback/give-feedback.component.ts` (CREATE)
- `give-feedback/give-feedback.component.html` (CREATE)
- `give-feedback/give-feedback.component.sass` (CREATE)

Modal/form component for providing feedback with:
- Feedback content textarea
- Feedback type dropdown (General, Performance, Collaboration, etc.)
- Rating selector (1-10 scale)
- Anonymous checkbox option
- Form validation
- Submit functionality

### Update Existing Components

#### Profile Component Updates
**File**: `hr-app/src/app/features/profile/profile.component.ts` (MODIFY)
- Add "View My Feedback" button logic for own profile
- Add "Give Feedback" button logic for co-worker profiles
- Navigation methods to feedback pages
- Permission checks for feedback actions

**File**: `hr-app/src/app/features/profile/profile.component.html` (MODIFY)
- Add feedback buttons to profile interface
- Conditional rendering based on profile ownership

### Core Services

#### Feedback Service
**File**: `hr-app/src/app/core/services/feedback.service.ts` (CREATE)
- HTTP client methods for feedback API calls
- `getFeedbackForEmployee(employeeId: number): Observable<FeedbackListDto[]>`
- `createFeedback(feedback: CreateFeedbackDto): Observable<FeedbackDetailDto>`
- Error handling and response mapping

#### Update Models
**File**: `hr-app/src/app/core/models/feedback.models.ts` (CREATE)
- TypeScript interfaces matching backend DTOs
- `FeedbackListDto`, `CreateFeedbackDto`, `FeedbackDetailDto` interfaces
- `FeedbackType` enum

### Routing Updates
**File**: `hr-app/src/app/app.routes.ts` (MODIFY)
- Add route: `feedback/:employeeId` for viewing feedback list
- Route guards to ensure proper access permissions

## Key Algorithms & Business Logic

### Anonymous Feedback Display Algorithm
1. When retrieving feedback for display:
   - If `feedback.IsAnonymous === true`, replace sender information with "Anonymous"
   - If `feedback.IsAnonymous === false`, show actual sender name
   - Always show feedback content, rating, type, and date

### Feedback Permission Validation
1. **For viewing feedback**:
   - Own profile: Show all received feedback (anonymous and named)
   - Co-worker profile: No access to view their feedback
   - Manager: Can view all feedback of coworkers

2. **For giving feedback**:
   - Cannot give feedback to self (enforced by database constraint and UI)
   - Can give feedback to any co-worker
   - Must be authenticated user

### Feedback Creation Workflow
1. User clicks "Give Feedback" on co-worker profile
2. Modal opens with feedback form
3. User fills out content, selects type, rating, and anonymous option
4. Form validation ensures all required fields
5. Submit creates feedback via API
6. Success confirmation
7. show success message

## Implementation Notes

- **Existing Infrastructure**: Leverage existing Feedback model, database relationships, and authentication system
- **UI Consistency**: Follow existing component patterns and styling from profile and auth components
- **Error Handling**: Implement comprehensive error handling for API failures and validation errors
- **Security**: Ensure proper authorization checks prevent unauthorized feedback access
- **Performance**: Consider pagination for feedback lists if users have many feedback items
- **Accessibility**: Ensure feedback forms and lists are accessible with proper ARIA labels

## Files to be Created
- `HrAPI/HrAPI/Controllers/FeedbackController.cs`
- `HrAPI/HrAPI/DTOs/FeedbackDto.cs`
- `HrAPI/HrAPI/Services/IFeedbackService.cs`
- `HrAPI/HrAPI/Services/FeedbackService.cs`
- `hr-app/src/app/features/feedback/feedback-list/feedback-list.component.{ts,html,sass}`
- `hr-app/src/app/features/feedback/give-feedback/give-feedback.component.{ts,html,sass}`
- `hr-app/src/app/core/services/feedback.service.ts`
- `hr-app/src/app/core/models/feedback.models.ts`

## Files to be Modified
- `HrAPI/HrAPI/Program.cs`
- `hr-app/src/app/features/profile/profile.component.{ts,html}`
- `hr-app/src/app/app.routes.ts`
